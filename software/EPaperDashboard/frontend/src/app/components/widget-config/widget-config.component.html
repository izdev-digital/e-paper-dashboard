<ng-container [ngSwitch]="widget.type">

  <ng-container *ngSwitchCase="'header'">
    <div class="mb-3">
      <label class="form-label">Title</label>
      <input type="text" class="form-control" [(ngModel)]="headerConfig.title" />
    </div>
    <div class="mb-3">
      <label class="form-label">Badges</label>
      <ng-container *ngFor="let badge of headerConfig.badges; let i = index; trackBy: trackByBadgeLabel">
        <div class="badge-item mb-2">
          <div class="input-group input-group-sm">
            <input type="text" class="form-control" placeholder="Label" [(ngModel)]="badge.label" />
            <input type="text" class="form-control" placeholder="Icon (e.g., fa-home)" [(ngModel)]="badge.icon" />
            <button class="btn btn-danger" (click)="removeBadge(i)"><i class="fa fa-trash"></i></button>
          </div>
          <select class="form-select form-select-sm mt-1" [(ngModel)]="badge.entityId">
            <option [ngValue]="undefined">No Entity</option>
            <ng-container *ngFor="let entity of entities; trackBy: trackByEntityId">
              <option [ngValue]="entity.entity_id">{{ entity.friendly_name || entity.entity_id }}</option>
            </ng-container>
          </select>
          <button class="btn btn-sm btn-outline-primary w-100" (click)="addBadge()"><i class="fa fa-plus"></i> Add
            Badge</button>

          <ng-container *ngSwitchCase="'markdown'">
            <div class="mb-3">
              <label class="form-label">Content</label>
              <textarea class="form-control" rows="6" [(ngModel)]="markdownConfig.content"
                placeholder="# Markdown content here"></textarea>
            </div>


            <ng-container *ngSwitchCase="'calendar'">
              <div class="mb-3">
                <label class="form-label">Calendar Entity</label>
                <select class="form-select" [(ngModel)]="calendarConfig.entityId">
                  <option value="">Select entity...</option>
                  @for (entity of entities; track entity.entity_id) {
                  <option [value]="entity.entity_id">{{ entity.friendly_name || entity.entity_id }}</option>
                  }
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Max Events</label>
                <input type="number" class="form-control" [(ngModel)]="calendarConfig.maxEvents" min="1" max="20" />
              </div>


              <ng-container *ngSwitchCase="'weather'">
                <div class="mb-3">
                  <label class="form-label">Weather Entity</label>
                  <select class="form-select" [(ngModel)]="weatherConfig.entityId">
                    <option value="">Select entity...</option>
                    @for (entity of entities; track entity.entity_id) {
                    <option [value]="entity.entity_id">{{ entity.friendly_name || entity.entity_id }}</option>
                    }
                  </select>
                </div>
              </ng-container>

              <ng-container *ngSwitchCase="'weather-forecast'">
                <div class="mb-3">
                  <label class="form-label">Weather Entity</label>
                  <select class="form-select" [(ngModel)]="weatherForecastConfig.entityId">
                    <option value="">Select entity...</option>
                    @for (entity of entities; track entity.entity_id) {
                    <option [value]="entity.entity_id">{{ entity.friendly_name || entity.entity_id }}</option>
                    }
                  </select>
                </div>
              </ng-container>

              <ng-container *ngSwitchCase="'graph'">
                <div class="mb-3">
                  <label class="form-label">Sensor Entity</label>
                  <select class="form-select" [(ngModel)]="graphConfig.entityId">
                    <option value="">Select entity...</option>
                    @for (entity of entities; track entity.entity_id) {
                    <option [value]="entity.entity_id">{{ entity.friendly_name || entity.entity_id }}</option>
                    }
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Period</label>
                  <select class="form-select" [(ngModel)]="graphConfig.period">
                    <option value="1h">1 Hour</option>
                    <option value="6h">6 Hours</option>
                    <option value="24h">24 Hours</option>
                    <option value="7d">7 Days</option>
                    <option value="30d">30 Days</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Label (optional)</label>
                  <input type="text" class="form-control" [(ngModel)]="graphConfig.label" />
                </div>
              </ng-container>

              <ng-container *ngSwitchCase="'todo'">
                <div class="mb-3">
                  <label class="form-label">Todo Entity</label>
                  <select class="form-select" [(ngModel)]="todoConfig.entityId">
                    <option value="">Select entity...</option>
                    @for (entity of entities; track entity.entity_id) {
                    <option [value]="entity.entity_id">{{ entity.friendly_name || entity.entity_id }}</option>
                    }
                  </select>
                </div>
              </ng-container>

              <ng-container *ngSwitchCase="'display'">
                <ng-container *ngIf="widget.config && 'text' in widget.config">
                  <div class="mb-3">
                    <label class="form-label">Text</label>
                    <input type="text" class="form-control" [(ngModel)]="widget.config.text" />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Font Size</label>
                    <input type="number" class="form-control" [(ngModel)]="widget.config.fontSize" min="8" max="64" />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Color</label>
                    <input type="color" class="form-control form-control-color" [(ngModel)]="widget.config.color" />
                  </div>
                </ng-container>
              </ng-container>

              <ng-container *ngSwitchCase="'app-icon'">
                <ng-container *ngIf="widget.config && ('iconUrl' in widget.config || 'size' in widget.config)">
                  <div class="mb-3">
                    <label class="form-label">Icon URL (optional)</label>
                    <input type="text" class="form-control" [(ngModel)]="widget.config.iconUrl"
                      placeholder="Leave blank for default app icon" />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Size (px)</label>
                    <input type="number" class="form-control" [(ngModel)]="widget.config.size" min="16" max="256" />
                  </div>
                </ng-container>
              </ng-container>

              <ng-container *ngSwitchCase="'image'">
                <ng-container *ngIf="widget.config && 'imageUrl' in widget.config">
                  <div class="mb-3">
                    <label class="form-label">Image URL</label>
                    <input type="text" class="form-control" [(ngModel)]="widget.config.imageUrl"
                      placeholder="https://... or /assets/..." />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Fit</label>
                    <select class="form-select" [(ngModel)]="widget.config.fit">
                      <option value="contain">Contain</option>
                      <option value="cover">Cover</option>
                      <option value="fill">Fill</option>
                    </select>
                  </div>
                </ng-container>
              </ng-container>