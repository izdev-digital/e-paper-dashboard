<div class="row">
  <div class="col-md-8 offset-md-2">
    <h2>My Profile</h2>

    <p><strong>Username:</strong> {{ currentUser?.username }}</p>

    @if (isUserManagementDisabled()) {
    <div class="alert alert-info">
      <i class="fa-solid fa-info-circle me-2"></i>
      User management is disabled in this deployment mode. Profile settings are not available.
    </div>
    } @else {
    <form (ngSubmit)="changeNickname()" class="mb-4">
      <p><strong>Nickname:</strong> {{ currentUser?.nickname || '(not set)' }}</p>
      <div class="mb-3">
        <label for="newNickname" class="form-label">New Nickname</label>
        <input type="text" class="form-control" id="newNickname" [value]="newNickname()"
          (input)="newNickname.set($any($event.target).value)" [disabled]="isChangingNickname()" />
      </div>
      <button type="submit" class="btn btn-primary" [disabled]="isChangingNickname()">
        @if (isChangingNickname()) {
        <span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>
        }
        Change Nickname
      </button>
    </form>

    <form (ngSubmit)="changePassword()" class="mb-4">
      <h4>Change Password</h4>
      <div class="mb-3">
        <label for="currentPassword" class="form-label">Current Password</label>
        <input type="password" class="form-control" id="currentPassword" [value]="currentPassword()"
          (input)="currentPassword.set($any($event.target).value)" [disabled]="isChangingPassword()" required />
      </div>
      <div class="mb-3">
        <label for="newPassword" class="form-label">New Password</label>
        <input type="password" class="form-control" id="newPassword" [value]="newPassword()"
          (input)="newPassword.set($any($event.target).value)" [disabled]="isChangingPassword()" required />
      </div>
      <div class="mb-3">
        <label for="confirmNewPassword" class="form-label">Confirm Password</label>
        <input type="password" class="form-control" id="confirmNewPassword" [value]="confirmNewPassword()"
          (input)="confirmNewPassword.set($any($event.target).value)" [disabled]="isChangingPassword()" required />
      </div>
      <button type="submit" class="btn btn-primary" [disabled]="isChangingPassword()">
        @if (isChangingPassword()) {
        <span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>
        }
        Change Password
      </button>
    </form>

    <form (ngSubmit)="deleteProfile()">
      <button type="submit" class="btn btn-danger" [disabled]="isDeletingProfile()">
        @if (isDeletingProfile()) {
        <span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>
        }
        Delete My Profile
      </button>
    </form>
    }
  </div>
</div>